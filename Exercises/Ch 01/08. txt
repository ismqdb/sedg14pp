See gcd_3() for implementation.