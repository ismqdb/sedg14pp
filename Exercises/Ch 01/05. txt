See binary.cpp for implementation.